<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>어휘끝 고교기본 문장제 시험</title>
    <style>
        :root { --main-purple: #5c5cf4; --bg-gray: #f0f2f5; --error-red: #ff4d4d; --success-green: #2ecc71; }
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background-color: var(--bg-gray); margin: 0; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; width: 100%; max-width: 500px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); padding: 30px; box-sizing: border-box; text-align: center; }
        
        .btn { width: 100%; border: none; border-radius: 12px; padding: 16px; font-size: 16px; font-weight: 700; cursor: pointer; color: white; margin-bottom: 12px; transition: 0.2s; }
        .btn-purple { background-color: var(--main-purple); }
        .btn-gray { background-color: #636e72; }

        .screen { display: none; } .active { display: block; }
        
        input[type="text"] { width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 17px; box-sizing: border-box; outline: none; }

        .header { display: flex; justify-content: space-between; font-weight: 800; margin-bottom: 25px; font-size: 18px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
        .card { background: #f8f9fa; border-radius: 18px; padding: 30px; margin-bottom: 25px; line-height: 1.6; text-align: left; }
        .en { font-size: 20px; margin-bottom: 12px; color: #2d3436; font-weight: 500; }
        .ko-hint { font-size: 16px; color: var(--main-purple); font-weight: 600; }
        .blank { color: var(--main-purple); font-weight: 800; text-decoration: underline; }

        .wrong-list { max-height: 350px; overflow-y: auto; text-align: left; border: 1px solid #eee; padding: 15px; border-radius: 12px; margin-bottom: 25px; background: #fff; }
        .wrong-item { border-bottom: 1px solid #f0f0f0; padding: 15px 0; font-size: 14px; }
        .correct-ans { color: #0984e3; font-weight: 700; }
        .wrong-ans { color: var(--error-red); font-weight: 700; }
    </style>
</head>
<body>

<div class="container">
    <div id="quiz-screen" class="screen">
        <div class="header">
            <span id="unit-name">Quiz</span>
            <span id="progress">0 / 0</span>
        </div>
        <div class="card">
            <div class="en" id="en-text"></div>
            <div class="ko-hint" id="ko-text"></div>
        </div>
        <input type="text" id="user-input" placeholder="정답을 입력하세요..." autocomplete="off">
        <button class="btn btn-purple" style="margin-top:10px;" onclick="handleNext()">제출</button>
    </div>

    <div id="result-screen" class="screen">
        <h2 style="font-size:24px; font-weight:800; margin-top:0;">퀴즈 결과</h2>
        <div id="res-student" style="font-weight:700; font-size:18px; margin-bottom:10px;"></div>
        <div id="final-score" style="color:var(--main-purple); font-weight:800; font-size:20px; margin-bottom:25px;"></div>
        <div style="text-align:left; font-weight:800; margin-bottom:10px;">틀린 문제 내역</div>
        <div class="wrong-list" id="wrong-list"></div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button class="btn btn-purple" onclick="downloadResult()">결과 저장</button>
            <button class="btn btn-gray" onclick="location.href='cedusatst.html'">돌아가기</button>
        </div>
    </div>
</div>

<script>
    /* 데이터부: AI Studio 생성 데이터 삽입 */
    const quizData = { "Vocabulary Quiz": [
    { "sentence": "It is helpful to compare the prices before buying.", "ko": "구매하기 전에 가격을 비교하는 것이 도움이 된다.", "word": "compare" },
    { "sentence": "Life is often compared to a voyage.", "ko": "인생은 종종 항해에 비유된다.", "word": "compared" },
    { "sentence": "Let's divide the cake into six pieces.", "ko": "케이크를 여섯 조각으로 나누자.", "word": "divide" },
    { "sentence": "The river divides into two branches here.", "ko": "강이 여기에서 두 갈래로 갈라진다.", "word": "divides" },
    { "sentence": "It is difficult to relate these two events.", "ko": "이 두 사건을 관련시키는 것은 어렵다.", "word": "relate" },
    { "sentence": "The symptoms relate to a lack of sleep.", "ko": "그 증상들은 수면 부족과 관련이 있다.", "word": "relate" },
    { "sentence": "He decided to leave the company next month.", "ko": "그는 다음 달에 회사를 떠나기로 결정했다.", "word": "leave" },
    { "sentence": "Don't leave your umbrella in the bus.", "ko": "버스에 우산을 두고 남기지 마세요.", "word": "leave" },
    { "sentence": "Please follow me to the meeting room.", "ko": "회의실까지 저를 따라오세요.", "word": "follow" },
    { "sentence": "You must follow the safety instructions.", "ko": "당신은 안전 지시를 따라야 합니다.", "word": "follow" },
    { "sentence": "I'm sorry, I don't follow what you're saying.", "ko": "죄송합니다만, 당신이 하는 말을 이해하지 못하겠어요.", "word": "follow" },
    { "sentence": "She had to endure many hardships.", "ko": "그녀는 많은 고난을 견뎌야 했다.", "word": "endure" },
    { "sentence": "Their friendship has endured for decades.", "ko": "그들의 우정은 수십 년 동안 지속되었다.", "word": "endured" },
    { "sentence": "My parents forbid me from staying out late.", "ko": "부모님은 내가 늦게까지 밖에 있는 것을 금지하신다.", "word": "forbid" },
    { "sentence": "It's important to control your emotions.", "ko": "당신의 감정을 통제하는 것이 중요하다.", "word": "control" },
    { "sentence": "The dictator tried to control the whole country.", "ko": "독재자는 나라 전체를 지배하려 했다.", "word": "control" },
    { "sentence": "This switch controls the brightness of the light.", "ko": "이 스위치는 빛의 밝기를 조절한다.", "word": "controls" },
    { "sentence": "You need to focus on your studies.", "ko": "너는 학업에 집중할 필요가 있다.", "word": "focus" },
    { "sentence": "The photographer focused the lens on the flower.", "ko": "사진작가는 꽃에 렌즈의 초점을 맞췄다.", "word": "focused" },
    { "sentence": "I can't concentrate because of the noise.", "ko": "시끄러워서 집중할 수가 없다.", "word": "concentrate" },
    { "sentence": "The juice is made from concentrated orange extract.", "ko": "그 주스는 농축된 오렌지 추출물로 만들어졌다.", "word": "concentrated" },
    { "sentence": "Demand will determine the price of the product.", "ko": "수요가 제품의 가격을 결정할 것이다.", "word": "determine" },
    { "sentence": "She determined to pass the exam this time.", "ko": "그녀는 이번에 시험에 합격하기로 결심했다.", "word": "determined" },
    { "sentence": "Experts are trying to determine the cause of the fire.", "ko": "전문가들이 화재 원인을 밝혀내려 노력하고 있다.", "word": "determine" },
    { "sentence": "What do you conclude from the evidence?", "ko": "증거로부터 어떤 결론을 내리시겠습니까?", "word": "conclude" },
    { "sentence": "The meeting concluded with a brief prayer.", "ko": "그 회의는 짧은 기도로 끝났다.", "word": "concluded" },
    { "sentence": "The key doesn't fit the lock.", "ko": "그 열쇠는 자물쇠에 맞지 않는다.", "word": "fit" },
    { "sentence": "This dress fits you perfectly.", "ko": "이 드레스는 당신에게 아주 잘 어울린다.", "word": "fits" },
    { "sentence": "This book belongs to the library.", "ko": "이 책은 도서관의 소유이다.", "word": "belongs" },
    { "sentence": "I feel like I don't belong here.", "ko": "나는 여기에 속해 있지 않다는 느낌이 든다.", "word": "belong" },
    { "sentence": "Earthquakes occur frequently in this region.", "ko": "이 지역에서는 지진이 빈번하게 발생한다.", "word": "occur" },
    { "sentence": "An interesting idea occurred to me.", "ko": "흥미로운 생각이 나에게 떠올랐다.", "word": "occurred" },
    { "sentence": "These plants occur naturally in the wild.", "ko": "이 식물들은 야생에서 자연적으로 존재한다.", "word": "occur" },
    { "sentence": "I didn't notice that you were there.", "ko": "나는 네가 거기 있는 것을 알아차리지 못했다.", "word": "notice" },
    { "sentence": "The audience noticed her talent immediately.", "ko": "청중은 그녀의 재능을 즉시 주목했다.", "word": "noticed" },
    { "sentence": "The boss noticed the staff of the upcoming meeting.", "ko": "상사는 직원들에게 다가올 회의를 통지했다.", "word": "noticed" },
    { "sentence": "Please inform us of any changes in your address.", "ko": "주소가 변경되면 저희에게 알려 주시기 바랍니다.", "word": "inform" },
    { "sentence": "Suppose you won the lottery, what would you do?", "ko": "네가 복권에 당첨되었다고 가정하면 무엇을 하겠니?", "word": "Suppose" },
    { "sentence": "I suppose he will be late again.", "ko": "그가 또 늦을 것이라고 생각한다.", "word": "suppose" },
    { "sentence": "She pretended to be asleep when I entered.", "ko": "내가 들어갔을 때 그녀는 자는 척했다.", "word": "pretended" },
    { "sentence": "I suggest that we take a break.", "ko": "나는 우리가 휴식을 취할 것을 제안한다.", "word": "suggest" },
    { "sentence": "Recent data suggests a change in the climate.", "ko": "최근 자료는 기후의 변화를 암시한다.", "word": "suggests" },
    { "sentence": "The child is developing very fast.", "ko": "그 아이는 매우 빠르게 발달하고 있다.", "word": "developing" },
    { "sentence": "Scientists are developing a new vaccine.", "ko": "과학자들은 새로운 백신을 개발하고 있다.", "word": "developing" },
    { "sentence": "I need to have this film developed.", "ko": "이 필름을 현상해야 한다.", "word": "developed" },
    { "sentence": "Can you locate the city on this map?", "ko": "이 지도에서 그 도시의 위치를 찾아낼 수 있니?", "word": "locate" },
    { "sentence": "The hotel is located near the beach.", "ko": "그 호텔은 해변 근처에 위치하고 있다.", "word": "located" },
    { "sentence": "The teacher decided to seperate the two students.", "ko": "선생님은 그 두 학생을 분리하기로 결정했다.", "word": "seperate" },
    { "sentence": "The couple decided to seperate after many arguments.", "ko": "그 부부는 많은 다툼 끝에 헤어지기로 했다.", "word": "seperate" },
    { "sentence": "The sun disappeared behind the clouds.", "ko": "태양이 구름 뒤로 사라졌다.", "word": "disappeared" },
    { "sentence": "Many people suffer from allergies in spring.", "ko": "많은 사람들이 봄에 알레르기로 고통을 받는다.", "word": "suffer" },
    { "sentence": "The company suffered a huge loss this year.", "ko": "그 회사는 올해 큰 손해를 겪었다.", "word": "suffered" },
    { "sentence": "This job requires a lot of patience.", "ko": "이 일은 많은 인내심을 필요로 한다.", "word": "requires" },
    { "sentence": "Seat belts help prevent injuries.", "ko": "안전벨트는 부상을 막는 데 도움이 된다.", "word": "prevent" },
    { "sentence": "Good hygiene can prevent many diseases.", "ko": "좋은 위생은 많은 질병을 예방할 수 있다.", "word": "prevent" },
    { "sentence": "The teacher knows how to motivate students.", "ko": "그 선생님은 학생들에게 동기를 부여하는 법을 안다.", "word": "motivate" },
    { "sentence": "Fear of failure can motivate people to work hard.", "ko": "실패에 대한 두려움이 사람들이 열심히 일하는 이유가 될 수 있다.", "word": "motivate" },
    { "sentence": "He likes to socialize with his colleagues after work.", "ko": "그는 퇴근 후에 동료들과 어울리는 것을 좋아한다.", "word": "socialize" },
    { "sentence": "Schools help to socialize children.", "ko": "학교는 아이들을 사회화시키는 것을 돕는다.", "word": "socialize" },
    { "sentence": "A crowd gathered to see the performance.", "ko": "공연을 보기 위해 군중이 모였다.", "word": "gathered" },
    { "sentence": "She gathered some flowers from the garden.", "ko": "그녀는 정원에서 꽃을 좀 모았다.", "word": "gathered" }
] };

    let currentSet = []; let idx = 0; let results = []; let studentName = "";

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    window.onload = function() {
        studentName = window.prompt("학생 이름을 입력하세요.", "");
        if (!studentName || !studentName.trim()) {
            document.querySelector('.container').innerHTML = '<h1>시험이 취소되었습니다. 새로고침 후 다시 시도하세요.</h1>';
            return;
        }
        studentName = studentName.trim();
        
        const unitKey = Object.keys(quizData)[0];
        if (!unitKey || !quizData[unitKey] || quizData[unitKey].length === 0) {
            document.querySelector('.container').innerHTML = '<h1>퀴즈 데이터를 불러올 수 없습니다.</h1>';
            return;
        }

        let allQuestions = quizData[unitKey];
        currentSet = shuffle([...allQuestions]).slice(0, 40);
        
        if (currentSet.length === 0) {
            document.querySelector('.container').innerHTML = '<h1>문제가 없습니다.</h1>';
            return;
        }
        
        idx = 0;
        results = [];
        document.getElementById('quiz-screen').classList.add('active');
        document.getElementById('unit-name').textContent = unitKey;
        showQ();
    };

    function showQ() {
        if (idx >= currentSet.length) {
            showResult();
            return;
        }
        const q = currentSet[idx];
        const blank = q.word[0] + "_".repeat(q.word.length - 1);
        const regex = new RegExp("\\b" + q.word + "\\b", "gi");
        document.getElementById('en-text').innerHTML = q.sentence.replace(regex, `<span class="blank">${blank}</span>`);
        document.getElementById('ko-text').textContent = q.ko;
        document.getElementById('progress').textContent = (idx + 1) + " / " + currentSet.length;
        document.getElementById('user-input').value = "";
        document.getElementById('user-input').focus();
    }

    function handleNext() {
        const userAns = document.getElementById('user-input').value.trim().toLowerCase();
        if (!userAns) return; 
        const correctAns = currentSet[idx].word.toLowerCase();
        results.push({ q: currentSet[idx], user: userAns, isCorrect: userAns === correctAns });
        idx++;
        if (idx < currentSet.length) {
            showQ();
        } else {
            showResult();
        }
    }
    
    document.getElementById('user-input').addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            handleNext();
        }
    });

    function showResult() {
        document.getElementById('quiz-screen').classList.remove('active');
        document.getElementById('result-screen').classList.add('active');
        const correctCount = results.filter(r => r.isCorrect).length;
        document.getElementById('res-student').textContent = studentName + " 학생";
        document.getElementById('final-score').textContent = `총 ${results.length}문제 중 ${correctCount}문제 정답`;
        
        const listHtml = results.filter(r => !r.isCorrect).map(r => `
            <div class="wrong-item">
                <div style="margin-bottom:5px;">${r.q.sentence.replace(new RegExp(r.q.word, 'gi'), `<b style="color:red">${r.q.word}</b>`)}</div>
                <div style="font-size:12px; color:blue;">정답: <b class="correct-ans">${r.q.word}</b> | 입력: <b class="wrong-ans">${r.user || '미입력'}</b></div>
            </div>
        `).join('');
        document.getElementById('wrong-list').innerHTML = listHtml || "<div style='padding:20px; color:var(--success-green); font-weight:bold;'>만점입니다!</div>";
    }

    function downloadResult() {
        const correctCount = results.filter(r => r.isCorrect).length;
        const unitName = document.getElementById('unit-name').textContent;
        let content = `학생명 : ${studentName}\n유닛명 : ${unitName}\n점  수 : ${results.length} 중 ${correctCount}\n\n[오답 기록]\n`;
        results.filter(r => !r.isCorrect).forEach((r, i) => {
            content += `${i+1}. 정답: ${r.q.word}, 내 입력: ${r.user}\n   문장: ${r.q.sentence}\n\n`;
        });
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
        a.download = `결과_${studentName}_${unitName}.txt`;
        a.click();
    }
</script>
</body>
</html>