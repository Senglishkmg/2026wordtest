<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>어휘끝 고교기본 문장제 시험</title>
    <style>
        :root { --main-purple: #5c5cf4; --bg-gray: #f0f2f5; --error-red: #ff4d4d; --success-green: #2ecc71; }
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background-color: var(--bg-gray); margin: 0; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; width: 100%; max-width: 500px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); padding: 30px; box-sizing: border-box; text-align: center; }
        
        .btn { width: 100%; border: none; border-radius: 12px; padding: 16px; font-size: 16px; font-weight: 700; cursor: pointer; color: white; margin-bottom: 12px; transition: 0.2s; }
        .btn-purple { background-color: var(--main-purple); }
        .btn-gray { background-color: #636e72; }

        .screen { display: none; } .active { display: block; }
        
        input[type="text"] { width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 17px; box-sizing: border-box; outline: none; }

        .header { display: flex; justify-content: space-between; font-weight: 800; margin-bottom: 25px; font-size: 18px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
        .card { background: #f8f9fa; border-radius: 18px; padding: 30px; margin-bottom: 25px; line-height: 1.6; text-align: left; }
        .en { font-size: 20px; margin-bottom: 12px; color: #2d3436; font-weight: 500; }
        .ko-hint { font-size: 16px; color: var(--main-purple); font-weight: 600; }
        .blank { color: var(--main-purple); font-weight: 800; text-decoration: underline; }

        .wrong-list { max-height: 350px; overflow-y: auto; text-align: left; border: 1px solid #eee; padding: 15px; border-radius: 12px; margin-bottom: 25px; background: #fff; }
        .wrong-item { border-bottom: 1px solid #f0f0f0; padding: 15px 0; font-size: 14px; }
        .correct-ans { color: #0984e3; font-weight: 700; }
        .wrong-ans { color: var(--error-red); font-weight: 700; }
    </style>
</head>
<body>

<div class="container">
    <div id="quiz-screen" class="screen">
        <div class="header">
            <span id="unit-name">Quiz</span>
            <span id="progress">0 / 0</span>
        </div>
        <div class="card">
            <div class="en" id="en-text"></div>
            <div class="ko-hint" id="ko-text"></div>
        </div>
        <input type="text" id="user-input" placeholder="정답을 입력하세요..." autocomplete="off">
        <button class="btn btn-purple" style="margin-top:10px;" onclick="handleNext()">제출</button>
    </div>

    <div id="result-screen" class="screen">
        <h2 style="font-size:24px; font-weight:800; margin-top:0;">퀴즈 결과</h2>
        <div id="res-student" style="font-weight:700; font-size:18px; margin-bottom:10px;"></div>
        <div id="final-score" style="color:var(--main-purple); font-weight:800; font-size:20px; margin-bottom:25px;"></div>
        <div style="text-align:left; font-weight:800; margin-bottom:10px;">틀린 문제 내역</div>
        <div class="wrong-list" id="wrong-list"></div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button class="btn btn-purple" onclick="downloadResult()">결과 저장</button>
            <button class="btn btn-gray" onclick="location.href='cedusatst.html'">돌아가기</button>
        </div>
    </div>
</div>

<script>
    /* 데이터부: AI Studio 생성 데이터 삽입 */
    const quizData = {
        "Unit 18": [
            { "sentence": "Scientists are still studying the origin of the universe.", "ko": "과학자들은 여전히 우주의 기원을 연구하고 있다.", "word": "origin" },
            { "sentence": "She is proud of her French origin.", "ko": "그녀는 자신의 프랑스 출신을 자랑스러워한다.", "word": "origin" },
            { "sentence": "The structure of the building is very complex.", "ko": "그 건물의 구조는 매우 복잡하다.", "word": "structure" },
            { "sentence": "The hospital has a hierarchical structure.", "ko": "그 병원은 계층적인 조직 체계를 가지고 있다.", "word": "structure" },
            { "sentence": "The bridge is a massive steel structure.", "ko": "그 다리는 거대한 강철 구조물이다.", "word": "structure" },
            { "sentence": "You should structure your essay more logically.", "ko": "너는 너의 에세이를 더 논리적으로 구성해야 한다.", "word": "structure" },
            { "sentence": "These items fall into the same category.", "ko": "이 품목들은 같은 범주에 속한다.", "word": "category" },
            { "sentence": "What sort of food do you like?", "ko": "당신은 어떤 종류의 음식을 좋아하시나요?", "word": "sort" },
            { "sentence": "She sorted the documents into files.", "ko": "그녀는 서류들을 파일로 분류했다.", "word": "sorted" },
            { "sentence": "We should focus on quality rather than price.", "ko": "우리는 가격보다는 질에 집중해야 한다.", "word": "quality" },
            { "sentence": "The restaurant is known for its quality ingredients.", "ko": "그 식당은 양질의 재료로 유명하다.", "word": "quality" },
            { "sentence": "Honesty is one of her best qualities.", "ko": "정직함은 그녀의 가장 좋은 자질 중 하나이다.", "word": "qualities" },
            { "sentence": "It's a matter of quantity, not quality.", "ko": "그것은 질이 아니라 양의 문제이다.", "word": "quantity" },
            { "sentence": "They produce large quantities of oil.", "ko": "그들은 다량의 기름을 생산한다.", "word": "quantities" },
            { "sentence": "There is no reason to worry about it.", "ko": "그것에 대해 걱정할 이유는 없다.", "word": "reason" },
            { "sentence": "Humans are capable of logic and reason.", "ko": "인간은 논리와 이성을 사용할 수 있다.", "word": "reason" },
            { "sentence": "He reasoned that the plan would fail.", "ko": "그는 그 계획이 실패할 것이라고 추론했다.", "word": "reasoned" },
            { "sentence": "Each aspect of the problem was discussed.", "ko": "그 문제의 각 측면이 논의되었다.", "word": "aspect" },
            { "sentence": "The school year is divided into two terms.", "ko": "학기는 두 학기로 나뉜다.", "word": "terms" },
            { "sentence": "You should explain it in simple terms.", "ko": "당신은 그것을 쉬운 용어로 설명해야 한다.", "word": "terms" },
            { "sentence": "Please read the terms of the contract.", "ko": "계약 조건을 읽어주세요.", "word": "terms" },
            { "sentence": "The Victorian period was an era of change.", "ko": "빅토리아 시대는 변화의 시대였다.", "word": "period" },
            { "sentence": "Put a period at the end of the sentence.", "ko": "문장 끝에 마침표를 찍으세요.", "word": "period" },
            { "sentence": "The training session lasted for three hours.", "ko": "훈련 시간은 3시간 동안 지속되었다.", "word": "session" },
            { "sentence": "The project was cancelled due to lack of funds.", "ko": "그 프로젝트는 자금 부족으로 취소되었다.", "word": "funds" },
            { "sentence": "The research was funded by the government.", "ko": "그 연구는 정부에 의해 자금이 지원되었다.", "word": "funded" },
            { "sentence": "I've met him on several occasions.", "ko": "나는 그를 여러 번 만난 적이 있다.", "word": "occasions" },
            { "sentence": "The wedding was a very special occasion.", "ko": "그 결혼식은 매우 특별한 행사였다.", "word": "occasion" },
            { "sentence": "The car is in very good state.", "ko": "그 차는 매우 좋은 상태이다.", "word": "state" },
            { "sentence": "The state must protect its citizens.", "ko": "국가는 시민을 보호해야 한다.", "word": "state" },
            { "sentence": "There are fifty states in the USA.", "ko": "미국에는 50개의 주가 있다.", "word": "states" },
            { "sentence": "He stated his opinion clearly.", "ko": "그는 자신의 의견을 분명하게 밝혔다.", "word": "stated" },
            { "sentence": "We cannot continue under these circumstances.", "ko": "우리는 이런 상황 하에서 계속할 수 없다.", "word": "circumstances" },
            { "sentence": "The police are investigating the circumstances of the accident.", "ko": "경찰이 사고의 전후 사정을 조사하고 있다.", "word": "circumstances" },
            { "sentence": "This electronic device is easy to use.", "ko": "이 전자 장치는 사용하기 쉽다.", "word": "device" },
            { "sentence": "The shop sells a wide range of goods.", "ko": "그 상점은 다양한 상품을 판매한다.", "word": "goods" },
            { "sentence": "Water is a precious commodity.", "ko": "물은 귀중한 상품이다.", "word": "commodity" },
            { "sentence": "Gold and oil are major commodities.", "ko": "금과 석유는 주요 원자재이다.", "word": "commodities" },
            { "sentence": "The tourism industry is growing rapidly.", "ko": "관광 산업이 빠르게 성장하고 있다.", "word": "industry" },
            { "sentence": "Success is the result of hard work and industry.", "ko": "성공은 노력과 근면의 결과이다.", "word": "industry" },
            { "sentence": "The cost of labor has increased.", "ko": "노동 비용이 증가했다.", "word": "labor" },
            { "sentence": "They labored in the fields all day.", "ko": "그들은 하루 종일 들판에서 일했다.", "word": "labored" },
            { "sentence": "Most of the land is used for agriculture.", "ko": "대부분의 땅은 농업을 위해 사용된다.", "word": "agriculture" },
            { "sentence": "Luck was a major factor in our success.", "ko": "운은 우리 성공의 주요 요인이었다.", "word": "factor" },
            { "sentence": "I read an interesting article about space.", "ko": "나는 우주에 관한 흥미로운 기사를 읽었다.", "word": "article" },
            { "sentence": "The constitution has many articles.", "ko": "헌법에는 많은 조항이 있다.", "word": "articles" },
            { "sentence": "A compass is a useful article for hikers.", "ko": "나침반은 등산객들에게 유용한 물건이다.", "word": "article" },
            { "sentence": "Military discipline is very strict.", "ko": "군대 규율은 매우 엄격하다.", "word": "discipline" },
            { "sentence": "It takes a lot of discipline to diet.", "ko": "다이어트를 하는 데는 많은 자제심이 필요하다.", "word": "discipline" },
            { "sentence": "Economics is a social science discipline.", "ko": "경제학은 사회과학 학문 분야이다.", "word": "discipline" },
            { "sentence": "He disciplined himself to wake up early.", "ko": "그는 일찍 일어나도록 자신을 단련했다.", "word": "disciplined" },
            { "sentence": "His theory has not been proven yet.", "ko": "그의 이론은 아직 증명되지 않았다.", "word": "theory" },
            { "sentence": "You must look at the word in context.", "ko": "너는 문맥 속에서 그 단어를 보아야 한다.", "word": "context" },
            { "sentence": "Every action has a consequence.", "ko": "모든 행동에는 결과가 따른다.", "word": "consequence" },
            { "sentence": "The matter is of great consequence.", "ko": "그 문제는 매우 중요하다.", "word": "consequence" },
            { "sentence": "Reporters must avoid political bias.", "ko": "기자들은 정치적 편견을 피해야 한다.", "word": "bias" },
            { "sentence": "The media biased the public against him.", "ko": "대중매체가 그에 대해 대중이 편견을 갖게 했다.", "word": "biased" },
            { "sentence": "Don't use that tone of voice with me.", "ko": "나에게 그런 말투를 쓰지 마라.", "word": "tone" },
            { "sentence": "The instrument has a beautiful tone.", "ko": "그 악기는 아름다운 음색을 가지고 있다.", "word": "tone" },
            { "sentence": "The painting uses warm tones of red.", "ko": "그 그림은 빨간색의 따뜻한 색조를 사용한다.", "word": "tones" },
            { "sentence": "Plants absorb moisture from the soil.", "ko": "식물은 토양으로부터 수분을 흡수한다.", "word": "moisture" }
        ]
    };

    let currentSet = []; let idx = 0; let results = []; let studentName = "";

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    window.onload = function() {
        studentName = window.prompt("학생 이름을 입력하세요.", "");
        if (!studentName || !studentName.trim()) {
            document.querySelector('.container').innerHTML = '<h1>시험이 취소되었습니다. 새로고침 후 다시 시도하세요.</h1>';
            return;
        }
        studentName = studentName.trim();
        
        const unitKey = Object.keys(quizData)[0];
        if (!unitKey || !quizData[unitKey] || quizData[unitKey].length === 0) {
            document.querySelector('.container').innerHTML = '<h1>퀴즈 데이터를 불러올 수 없습니다.</h1>';
            return;
        }

        let allQuestions = quizData[unitKey];
        currentSet = shuffle([...allQuestions]).slice(0, 40);
        
        if (currentSet.length === 0) {
            document.querySelector('.container').innerHTML = '<h1>문제가 없습니다.</h1>';
            return;
        }
        
        idx = 0;
        results = [];
        document.getElementById('quiz-screen').classList.add('active');
        document.getElementById('unit-name').textContent = unitKey;
        showQ();
    };

    function showQ() {
        if (idx >= currentSet.length) {
            showResult();
            return;
        }
        const q = currentSet[idx];
        const blank = q.word[0] + "_".repeat(q.word.length - 1);
        const regex = new RegExp("\\b" + q.word + "\\b", "gi");
        document.getElementById('en-text').innerHTML = q.sentence.replace(regex, `<span class="blank">${blank}</span>`);
        document.getElementById('ko-text').textContent = q.ko;
        document.getElementById('progress').textContent = (idx + 1) + " / " + currentSet.length;
        document.getElementById('user-input').value = "";
        document.getElementById('user-input').focus();
    }

    function handleNext() {
        const userAns = document.getElementById('user-input').value.trim().toLowerCase();
        if (!userAns) return; 
        const correctAns = currentSet[idx].word.toLowerCase();
        results.push({ q: currentSet[idx], user: userAns, isCorrect: userAns === correctAns });
        idx++;
        if (idx < currentSet.length) {
            showQ();
        } else {
            showResult();
        }
    }
    
    document.getElementById('user-input').addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            handleNext();
        }
    });

    function showResult() {
        document.getElementById('quiz-screen').classList.remove('active');
        document.getElementById('result-screen').classList.add('active');
        const correctCount = results.filter(r => r.isCorrect).length;
        document.getElementById('res-student').textContent = studentName + " 학생";
        document.getElementById('final-score').textContent = `총 ${results.length}문제 중 ${correctCount}문제 정답`;
        
        const listHtml = results.filter(r => !r.isCorrect).map(r => `
            <div class="wrong-item">
                <div style="margin-bottom:5px;">${r.q.sentence.replace(new RegExp(r.q.word, 'gi'), `<b style="color:red">${r.q.word}</b>`)}</div>
                <div style="font-size:12px; color:blue;">정답: <b class="correct-ans">${r.q.word}</b> | 입력: <b class="wrong-ans">${r.user || '미입력'}</b></div>
            </div>
        `).join('');
        document.getElementById('wrong-list').innerHTML = listHtml || "<div style='padding:20px; color:var(--success-green); font-weight:bold;'>만점입니다!</div>";
    }

    function downloadResult() {
        const correctCount = results.filter(r => r.isCorrect).length;
        const unitName = document.getElementById('unit-name').textContent;
        let content = `학생명 : ${studentName}\n유닛명 : ${unitName}\n점  수 : ${results.length} 중 ${correctCount}\n\n[오답 기록]\n`;
        results.filter(r => !r.isCorrect).forEach((r, i) => {
            content += `${i+1}. 정답: ${r.q.word}, 내 입력: ${r.user}\n   문장: ${r.q.sentence}\n\n`;
        });
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
        a.download = `결과_${studentName}_${unitName}.txt`;
        a.click();
    }
</script>
</body>
</html>