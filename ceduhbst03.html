<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>어휘끝 고교기본 문장제 시험</title>
    <style>
        :root { --main-purple: #5c5cf4; --bg-gray: #f0f2f5; --error-red: #ff4d4d; --success-green: #2ecc71; }
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background-color: var(--bg-gray); margin: 0; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; width: 100%; max-width: 500px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); padding: 30px; box-sizing: border-box; text-align: center; }
        
        .btn { width: 100%; border: none; border-radius: 12px; padding: 16px; font-size: 16px; font-weight: 700; cursor: pointer; color: white; margin-bottom: 12px; transition: 0.2s; }
        .btn-purple { background-color: var(--main-purple); }
        .btn-gray { background-color: #636e72; }

        .screen { display: none; } .active { display: block; }
        
        input[type="text"] { width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 17px; box-sizing: border-box; outline: none; }

        .header { display: flex; justify-content: space-between; font-weight: 800; margin-bottom: 25px; font-size: 18px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
        .card { background: #f8f9fa; border-radius: 18px; padding: 30px; margin-bottom: 25px; line-height: 1.6; text-align: left; }
        .en { font-size: 20px; margin-bottom: 12px; color: #2d3436; font-weight: 500; }
        .ko-hint { font-size: 16px; color: var(--main-purple); font-weight: 600; }
        .blank { color: var(--main-purple); font-weight: 800; text-decoration: underline; }

        .wrong-list { max-height: 350px; overflow-y: auto; text-align: left; border: 1px solid #eee; padding: 15px; border-radius: 12px; margin-bottom: 25px; background: #fff; }
        .wrong-item { border-bottom: 1px solid #f0f0f0; padding: 15px 0; font-size: 14px; }
        .correct-ans { color: #0984e3; font-weight: 700; }
        .wrong-ans { color: var(--error-red); font-weight: 700; }
    </style>
</head>
<body>

<div class="container">
    <div id="quiz-screen" class="screen">
        <div class="header">
            <span id="unit-name">Quiz</span>
            <span id="progress">0 / 0</span>
        </div>
        <div class="card">
            <div class="en" id="en-text"></div>
            <div class="ko-hint" id="ko-text"></div>
        </div>
        <input type="text" id="user-input" placeholder="정답을 입력하세요..." autocomplete="off">
        <button class="btn btn-purple" style="margin-top:10px;" onclick="handleNext()">제출</button>
    </div>

    <div id="result-screen" class="screen">
        <h2 style="font-size:24px; font-weight:800; margin-top:0;">퀴즈 결과</h2>
        <div id="res-student" style="font-weight:700; font-size:18px; margin-bottom:10px;"></div>
        <div id="final-score" style="color:var(--main-purple); font-weight:800; font-size:20px; margin-bottom:25px;"></div>
        <div style="text-align:left; font-weight:800; margin-bottom:10px;">틀린 문제 내역</div>
        <div class="wrong-list" id="wrong-list"></div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button class="btn btn-purple" onclick="downloadResult()">결과 저장</button>
            <button class="btn btn-gray" onclick="location.href='cedusatst.html'">돌아가기</button>
        </div>
    </div>
</div>

<script>
    /* 데이터부: AI Studio 생성 데이터 삽입 */
    const quizData = { "어휘끝 고교기본": [
        { "sentence": "You must submit your application by the end of the month.", "ko": "당신은 이달 말까지 지원서를 제출해야 합니다.", "word": "submit" },
        { "sentence": "He was forced to submit to the king's will.", "ko": "그는 왕의 의지에 굴복해야만 했다.", "word": "submit" },
        { "sentence": "I want to apply for the position of sales manager.", "ko": "나는 영업 매니저 직책에 지원하고 싶다.", "word": "apply" },
        { "sentence": "This rule does not apply to international students.", "ko": "이 규칙은 유학생들에게는 적용되지 않는다.", "word": "apply" },
        { "sentence": "Apply the cream gently to your face twice a day.", "ko": "하루에 두 번 얼굴에 크림을 부드럽게 바르세요.", "word": "Apply" },
        { "sentence": "Our team managed to defeat the champions in the final.", "ko": "우리 팀은 결승전에서 챔피언 팀을 이기는 데 성공했다.", "word": "defeat" },
        { "sentence": "The army suffered a heavy defeat in the battle.", "ko": "그 군대는 전투에서 심각한 패배를 겪었다.", "word": "defeat" },
        { "sentence": "He would never betray his country for money.", "ko": "그는 돈 때문에 나라를 배신하지 않을 것이다.", "word": "betray" },
        { "sentence": "The wildfire threatened to destroy the entire village.", "ko": "산불이 마을 전체를 파괴할 기세로 위협했다.", "word": "destroy" },
        { "sentence": "She was so exhausted that she had a collapse.", "ko": "그녀는 너무 기진맥진해서 쓰러졌다.", "word": "collapse" },
        { "sentence": "The old building could collapse at any moment.", "ko": "그 오래된 건물은 언제든지 붕괴될 수 있다.", "word": "collapse" },
        { "sentence": "The new project will involve a lot of research.", "ko": "새로운 프로젝트는 많은 연구를 수반할 것이다.", "word": "involve" },
        { "sentence": "They tried to involve him in the conspiracy.", "ko": "그들은 그를 음모에 연루시키려 했다.", "word": "involve" },
        { "sentence": "He continued to claim that he was innocent.", "ko": "그는 자신이 무죄라고 계속 주장했다.", "word": "claim" },
        { "sentence": "You can claim a refund within 30 days of purchase.", "ko": "구매 후 30일 이내에 환불을 요구할 수 있습니다.", "word": "claim" },
        { "sentence": "Workers are starting to demand higher wages.", "ko": "노동자들이 더 높은 임금을 요구하기 시작했다.", "word": "demand" },
        { "sentence": "The demand for organic food is increasing.", "ko": "유기농 식품에 대한 수요가 증가하고 있다.", "word": "demand" },
        { "sentence": "The store agreed to refund the full price of the item.", "ko": "그 상점은 물건값 전액을 환불해 주기로 동의했다.", "word": "refund" },
        { "sentence": "I am waiting for a tax refund from the government.", "ko": "나는 정부로부터 세금 환급금을 기다리고 있다.", "word": "refund" },
        { "sentence": "The restaurant will serve dinner until 10 PM.", "ko": "그 식당은 오후 10시까지 저녁 식사를 제공할 것이다.", "word": "serve" },
        { "sentence": "I hope my advice will serve to help you.", "ko": "내 조언이 당신에게 도움이 되기를 바랍니다.", "word": "serve" },
        { "sentence": "He had to serve in the navy for three years.", "ko": "그는 해군에서 3년 동안 복무해야 했다.", "word": "serve" },
        { "sentence": "Children tend to be curious about everything.", "ko": "아이들은 모든 것에 대해 호기심을 갖는 경향이 있다.", "word": "tend" },
        { "sentence": "A nurse was hired to tend to the elderly patient.", "ko": "노인 환자를 돌보기 위해 간호사가 고용되었다.", "word": "tend" },
        { "sentence": "Can you recommend a good restaurant nearby?", "ko": "근처에 좋은 식당을 추천해 주실 수 있나요?", "word": "recommend" },
        { "sentence": "She didn't respond to my question.", "ko": "그녀는 내 질문에 대답하지 않았다.", "word": "respond" },
        { "sentence": "The skin may respond negatively to the new soap.", "ko": "피부가 새 비누에 부정적으로 반응할 수도 있다.", "word": "respond" },
        { "sentence": "The company plans to initiate a new marketing campaign.", "ko": "그 회사는 새로운 마케팅 캠페인을 시작할 계획이다.", "word": "initiate" },
        { "sentence": "He didn't refer to the problem during the meeting.", "ko": "그는 회의 중에 그 문제에 대해 언급하지 않았다.", "word": "refer" },
        { "sentence": "The asterisk in the text refers to a footnote.", "ko": "본문의 별표는 각주를 가리킨다.", "word": "refers" },
        { "sentence": "You should refer to the dictionary for the meaning.", "ko": "의미를 알기 위해 사전을 참고해야 한다.", "word": "refer" },
        { "sentence": "How did the audience react to the performance?", "ko": "관객들이 그 공연에 어떻게 반응했나요?", "word": "react" },
        { "sentence": "The coach tried to reinforce the team's defense.", "ko": "감독은 팀의 수비를 강화하려고 노력했다.", "word": "reinforce" },
        { "sentence": "The country needs to export more to improve the economy.", "ko": "경제 상황을 개선하기 위해 그 나라는 더 많이 수출해야 한다.", "word": "export" },
        { "sentence": "The goal of the ad is to promote healthy living.", "ko": "그 광고의 목표는 건강한 생활을 장려하는 것이다.", "word": "promote" },
        { "sentence": "They hired a celebrity to promote the new perfume.", "ko": "그들은 신상 향수를 홍보하기 위해 유명인을 고용했다.", "word": "promote" },
        { "sentence": "The company decided to promote him to manager.", "ko": "회사는 그를 매니저로 승진시키기로 결정했다.", "word": "promote" },
        { "sentence": "Please proceed to the exit in an orderly manner.", "ko": "질서 있게 출구로 향해 주시기 바랍니다.", "word": "proceed" },
        { "sentence": "We will proceed with the plan as originally scheduled.", "ko": "우리는 원래 계획된 대로 그 계획을 계속 진행할 것입니다.", "word": "proceed" },
        { "sentence": "The detective tried to trace the source of the phone call.", "ko": "형사는 그 전화의 발신지를 추적하려고 노력했다.", "word": "trace" },
        { "sentence": "Don't tickle me, I'm very sensitive!", "ko": "나 간지럽히지 마, 나 아주 예민해!", "word": "tickle" },
        { "sentence": "My grandfather will retire from his job next year.", "ko": "우리 할아버지는 내년에 직장에서 은퇴하실 것이다.", "word": "retire" },
        { "sentence": "She helped organize the charity event.", "ko": "그녀는 자선 행사 준비를 도왔다.", "word": "organize" },
        { "sentence": "I need to organize my files before the deadline.", "ko": "나는 마감일 전에 파일들을 정리해야 한다.", "word": "organize" },
        { "sentence": "He wanted to organize a group for mountain climbing.", "ko": "그는 등산 동호회를 조직하고 싶어 했다.", "word": "organize" },
        { "sentence": "They are going to construct a new highway here.", "ko": "그들은 이곳에 새로운 고속도로를 건설할 예정이다.", "word": "construct" },
        { "sentence": "The scientist tried to construct a new theory.", "ko": "그 과학자는 새로운 이론을 구성하려고 노력했다.", "word": "construct" },
        { "sentence": "It is expensive to advertise on national television.", "ko": "전국 방송에 광고하는 것은 비용이 많이 든다.", "word": "advertise" },
        { "sentence": "The cat began to lick its fur to get clean.", "ko": "고양이는 깨끗해지기 위해 털을 핥기 시작했다.", "word": "lick" },
        { "sentence": "I'm sorry, I didn't mean to offend you.", "ko": "죄송합니다, 당신을 불쾌하게 하려던 의도는 아니었습니다.", "word": "offend" },
        { "sentence": "His behavior may offend against the laws of the land.", "ko": "그의 행동은 그 나라의 법에 어긋날 수도 있다.", "word": "offend" },
        { "sentence": "We might encounter some resistance to the new policy.", "ko": "우리는 새로운 정책에 대한 약간의 저항에 직면할 수도 있다.", "word": "encounter" },
        { "sentence": "It was a surprise to encounter an old friend in London.", "ko": "런던에서 옛 친구를 우연히 만난 것은 놀라운 일이었다.", "word": "encounter" }
    ] };

    let currentSet = []; let idx = 0; let results = []; let studentName = "";

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    window.onload = function() {
        studentName = window.prompt("학생 이름을 입력하세요.", "");
        if (!studentName || !studentName.trim()) {
            document.querySelector('.container').innerHTML = '<h1>시험이 취소되었습니다. 새로고침 후 다시 시도하세요.</h1>';
            return;
        }
        studentName = studentName.trim();
        
        const unitKey = Object.keys(quizData)[0];
        if (!unitKey || !quizData[unitKey] || quizData[unitKey].length === 0) {
            document.querySelector('.container').innerHTML = '<h1>퀴즈 데이터를 불러올 수 없습니다.</h1>';
            return;
        }

        let allQuestions = quizData[unitKey];
        currentSet = shuffle([...allQuestions]).slice(0, 40);
        
        if (currentSet.length === 0) {
            document.querySelector('.container').innerHTML = '<h1>문제가 없습니다.</h1>';
            return;
        }
        
        idx = 0;
        results = [];
        document.getElementById('quiz-screen').classList.add('active');
        document.getElementById('unit-name').textContent = unitKey;
        showQ();
    };

    function showQ() {
        if (idx >= currentSet.length) {
            showResult();
            return;
        }
        const q = currentSet[idx];
        const blank = q.word[0] + "_".repeat(q.word.length - 1);
        const regex = new RegExp("\\b" + q.word + "\\b", "gi");
        document.getElementById('en-text').innerHTML = q.sentence.replace(regex, `<span class="blank">${blank}</span>`);
        document.getElementById('ko-text').textContent = q.ko;
        document.getElementById('progress').textContent = (idx + 1) + " / " + currentSet.length;
        document.getElementById('user-input').value = "";
        document.getElementById('user-input').focus();
    }

    function handleNext() {
        const userAns = document.getElementById('user-input').value.trim().toLowerCase();
        if (!userAns) return; 
        const correctAns = currentSet[idx].word.toLowerCase();
        results.push({ q: currentSet[idx], user: userAns, isCorrect: userAns === correctAns });
        idx++;
        if (idx < currentSet.length) {
            showQ();
        } else {
            showResult();
        }
    }
    
    document.getElementById('user-input').addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            handleNext();
        }
    });

    function showResult() {
        document.getElementById('quiz-screen').classList.remove('active');
        document.getElementById('result-screen').classList.add('active');
        const correctCount = results.filter(r => r.isCorrect).length;
        document.getElementById('res-student').textContent = studentName + " 학생";
        document.getElementById('final-score').textContent = `총 ${results.length}문제 중 ${correctCount}문제 정답`;
        
        const listHtml = results.filter(r => !r.isCorrect).map(r => `
            <div class="wrong-item">
                <div style="margin-bottom:5px;">${r.q.sentence.replace(new RegExp(r.q.word, 'gi'), `<b style="color:red">${r.q.word}</b>`)}</div>
                <div style="font-size:12px; color:blue;">정답: <b class="correct-ans">${r.q.word}</b> | 입력: <b class="wrong-ans">${r.user || '미입력'}</b></div>
            </div>
        `).join('');
        document.getElementById('wrong-list').innerHTML = listHtml || "<div style='padding:20px; color:var(--success-green); font-weight:bold;'>만점입니다!</div>";
    }

    function downloadResult() {
        const correctCount = results.filter(r => r.isCorrect).length;
        const unitName = document.getElementById('unit-name').textContent;
        let content = `학생명 : ${studentName}\n유닛명 : ${unitName}\n점  수 : ${results.length} 중 ${correctCount}\n\n[오답 기록]\n`;
        results.filter(r => !r.isCorrect).forEach((r, i) => {
            content += `${i+1}. 정답: ${r.q.word}, 내 입력: ${r.user}\n   문장: ${r.q.sentence}\n\n`;
        });
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
        a.download = `결과_${studentName}_${unitName}.txt`;
        a.click();
    }
</script>
</body>
</html>